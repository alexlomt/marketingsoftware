"use strict";(()=>{var e={};e.id=844,e.ids=[844],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5900:e=>{e.exports=require("pg")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2781:e=>{e.exports=require("stream")},3837:e=>{e.exports=require("util")},6417:(e,a,r)=>{r.r(a),r.d(a,{headerHooks:()=>f,originalPathname:()=>j,patchFetch:()=>x,requestAsyncStorage:()=>p,routeModule:()=>m,serverHooks:()=>g,staticGenerationAsyncStorage:()=>d,staticGenerationBailout:()=>h});var t={};r.r(t),r.d(t,{POST:()=>l});var s=r(5419),n=r(9108),i=r(9678),o=r(8070),u=r(6686),c=r(9151);async function l(e,{params:a}){try{let r;let{id:t}=a,s=(0,c.mk)(e);if(!s)return o.Z.json({error:"Authentication required"},{status:401});let{action:n,scheduled_at:i,recipient_ids:l}=await e.json();if(!n)return o.Z.json({error:"Action is required"},{status:400});switch(n){case"schedule":if(!i)return o.Z.json({error:"Scheduled date/time is required"},{status:400});return r=await (0,u.Fr)(t,s,i),o.Z.json({message:"Email campaign scheduled successfully",campaign:r});case"cancel":return r=await (0,u.Tc)(t,s),o.Z.json({message:"Email campaign schedule cancelled successfully",campaign:r});case"send":if(!l||!Array.isArray(l)||0===l.length)return o.Z.json({error:"Recipient IDs are required"},{status:400});return r=await (0,u.ER)(t,s,l),o.Z.json({message:"Email campaign sent successfully",campaign:r});default:return o.Z.json({error:"Invalid action"},{status:400})}}catch(e){if(console.error("Email campaign action error:",e),"Email campaign not found"===e.message)return o.Z.json({error:"Email campaign not found"},{status:404});if("Cannot schedule a sent campaign"===e.message)return o.Z.json({error:"Cannot schedule a sent campaign"},{status:400});if("Can only cancel scheduled campaigns"===e.message)return o.Z.json({error:"Can only cancel scheduled campaigns"},{status:400});if("Campaign has already been sent"===e.message)return o.Z.json({error:"Campaign has already been sent"},{status:400});return o.Z.json({error:"Failed to perform action on email campaign"},{status:500})}}let m=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/email-campaigns/[id]/actions/route",pathname:"/api/email-campaigns/[id]/actions",filename:"route",bundlePath:"app/api/email-campaigns/[id]/actions/route"},resolvedPagePath:"/home/ubuntu/marketingsoftware/marketingsoftware-main/src/app/api/email-campaigns/[id]/actions/route.js",nextConfigOutput:"standalone",userland:t}),{requestAsyncStorage:p,staticGenerationAsyncStorage:d,serverHooks:g,headerHooks:f,staticGenerationBailout:h}=m,j="/api/email-campaigns/[id]/actions/route";function x(){return(0,i.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:d})}}};var a=require("../../../../../webpack-runtime.js");a.C(e);var r=e=>a(a.s=e),t=a.X(0,[1638,6206,7145,7439,1469],()=>r(6417));module.exports=t})();